<style>
  /* Nudge the publications block up (theme adds mt-16 / sm:mt-20) */
  .page-body .container.max-w-3xl.w-full[class*="mt-16"] {
    margin-top: 0.75rem !important;   /* reduce big top margin */
  }

  /* Year label spacing: keep it tight */
  .pub-year {
    margin: 2.5rem 0 0.5rem;    /* smaller top/bottom */
    font-weight: 600;
    font-size: 1.5rem;
  }
</style>

<script>
(function addYearHeaders(){
  function getYearFromItem(el){
    const txt = (el.textContent || '').replace(/\s+/g, ' ');
    const m = txt.match(/\((19|20)\d{2}\)/);
    return m ? m[0].slice(1,5) : '';
  }

  function run(){
    const root = document.body;
    if (!root || root.querySelector('.pub-year')) return;

    const items = Array.from(root.querySelectorAll('.pub-list-item.view-citation'));
    if (items.length < 2) return;

    let last = '';
    items.forEach(el => {
      const y = getYearFromItem(el);
      if (y && y !== last) {
        const h = document.createElement('h2');
        h.className = 'pub-year';
        h.id = 'y-' + y;
        h.textContent = y;
        el.parentNode.insertBefore(h, el);
        last = y;
      }
    });

    console.log('[pub-year] items:', items.length,
                'years sample:', items.slice(0,5).map(getYearFromItem));
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', run);
  } else {
    run();
  }
  window.addEventListener('load', () => setTimeout(run, 0));

  const obs = new MutationObserver((ms, ob) => {
    if (document.querySelector('.pub-list-item.view-citation') &&
        !document.querySelector('.pub-year')) {
      run(); ob.disconnect();
    }
  });
  obs.observe(document.documentElement, {childList:true, subtree:true});
})();
</script>
